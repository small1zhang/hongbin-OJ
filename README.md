
# 🧑‍💻 在线编程评测系统（Online Judge）

一个基于 SpringBoot + SpringCloud 构建的在线判题系统。
支持题目管理、在线编程、自动判题，并通过独立代码沙箱实现安全执行。

本项目的重点不在于功能堆砌，而在于 **判题流程设计、服务解耦与系统性能优化**。

---

# 🏗 整体架构设计

系统主要拆分为三个核心服务：

* **核心业务服务**（用户 / 题目 / 提交记录）
* **判题服务**
* **代码沙箱服务（独立部署）**

其中：

* 判题服务负责判题流程控制
* 沙箱服务负责代码编译与执行
* 二者通过 API 通信实现解耦

这种设计避免了主服务直接执行用户代码，提高了安全性，同时也为后续扩展多语言或分布式判题打下基础。

---

# ⚙ 判题流程

一次完整的判题过程如下：

1. 用户提交代码
2. 判题服务获取测试用例
3. 通过 RPC/HTTP 调用代码沙箱
4. 沙箱：

   * 编译代码
   * 执行代码
   * 收集执行时间 / 内存 / 输出结果
5. 判题服务比对标准输出
6. 更新提交状态并返回结果

支持多测试用例逐个执行与判定。

---

# 🛡 代码沙箱设计

代码沙箱为独立项目，基于 Docker 实现容器隔离：

* 动态创建与销毁容器
* 限制 CPU / 内存资源
* 禁止网络访问
* 设置执行超时
* 收集运行结果与异常信息

通过 Docker Java API 实现容器生命周期管理，避免恶意代码影响宿主机。

---

# 🚀 性能优化与架构升级

## 异步判题

最初采用同步判题模式，请求线程需等待判题完成，接口响应较慢。

后续基于 **RabbitMQ** 实现异步判题流程：

* 提交记录写入数据库
* 将提交 ID 投递至消息队列
* 判题服务异步消费
* 更新判题结果

压测结果（200 线程 JMeter）：

* 同步模式平均响应时间 ≈ 1.9s
* 异步模式平均响应时间 ≈ 120ms
* QPS 提升约 70%

---

## 缓存优化

基于 Redis 构建题目与高频查询缓存机制：

* 减少数据库访问压力
* 合理设置过期策略
* 提高接口响应速度

---

# 🧩 技术栈

* Java
* Spring Boot
* Spring Cloud
* MyBatis-Plus
* MySQL
* Redis
* RabbitMQ
* Nacos
* Docker
* Swagger + Knife4j

---

# 🌱 项目收获

* 理解在线判题系统完整流程
* 掌握服务拆分与解耦思想
* 实践容器级代码隔离
* 体验异步架构对系统吞吐的提升
* 熟悉缓存与性能优化策略

---

# 🔮 可扩展方向

* 支持多语言判题
* 分布式判题调度
* 判题结果缓存
* Kubernetes 容器调度
* Docker 镜像预热优化

---

# 📌 项目定位

该项目主要用于：

* 后端架构练习
* 判题系统原理理解
* 服务解耦实践
* 性能优化实验

